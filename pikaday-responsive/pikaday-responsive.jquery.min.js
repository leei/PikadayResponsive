/*! 
 * PikadayResponsive 
 * 
 * author: Francesco Novy 
 * licence: MIT license 
 * https://github.com/mydea/PikadayResponsive 
 */

!function($){$.fn.pikaday=function(options){var settings=$.extend({},$.fn.pikaday.defaults,options);return this.each(function(){var elem,input,container,self,picker,isPikaday;if(elem=$(this),self=this,this.clearDate=function(){$(this).parent(".pikaday-container").children("input").each(function(){$(this).val("").trigger("change")})},this.gotoToday=function(){isPikaday?($(this).siblings(".pikaday-display").val(moment().format(settings.displayFormat)).trigger("change"),picker.gotoToday()):$(this).siblings(".pikaday-invisible").val(moment().format("YYYY-MM-DD")).trigger("change")},"INPUT"!==elem.prop("tagName"))return console.error("Pikaday can only be intitialized on input-fields! Tried to initialized on: "),void console.error(elem);if(elem.attr("type","hidden"),elem.wrap("<span class='pikaday-container'></span>"),container=elem.parent(".pikaday-container"),!settings.forcePikaday&&settings.hasTouch&&settings.hasNativeDate){isPikaday=!1;var display=$("<input type='text' readonly class='pikaday-display pikaday-display-native "+settings.classes+"' placeholder='"+settings.placeholder+"' />");container.append(display),input=$("<input type='date' class='pikaday-invisible' />"),container.append(input),input.change(function(){if(""===$(this).val())return display.removeClass(""),elem.val(""),input.val(""),display.val(""),elem.val(""),void elem.trigger("change");var val,date=moment($(this).val(),"YYYY-MM-DD");!date.isValid()||date.unix()<0?(display.addClass("is-invalid"),input.val(""),display.val(""),elem.val("")):(display.removeClass("is-invalid"),display.val(date.format(settings.displayFormat)),val="unix"===settings.outputFormat?date.unix():"input"===settings.outputFormat?$(this).val():date.format(settings.outputFormat),elem.val(val)),elem.trigger("change")})}else{isPikaday=!0;var pikadayChanged=!1;input=$("<input type='text' class='pikaday-display "+settings.classes+"' placeholder='"+settings.placeholder+"' />"),container.append(input),picker=new Pikaday($.extend({},settings.pikadayOptions,{field:$(input)[0],format:settings.displayFormat})),elem.pikaday=picker,elem.val()&&picker.setMoment(moment.unix(elem.val())),elem.on("change",function(){if(pikadayChanged)return void(pikadayChanged=!1);pikadayChanged=!1;var val=$(this).val();val&&picker.setMoment(moment.unix(val))}),input.change(function(){if(pikadayChanged=!0,""===$(this).val()||0===$(this).val())return input.removeClass("is-invalid"),elem.val(""),input.val(""),elem.val(""),elem.trigger("change"),elem.addClass("is-empty"),void elem.parent().addClass("is-empty");elem.removeClass("is-empty"),elem.parent().removeClass("is-empty");var val,date=moment($(this).val(),settings.displayFormat);!date.isValid()||date.unix()<0?(input.addClass("is-invalid"),picker.gotoToday(),input.val(""),elem.val("")):(input.removeClass("is-invalid"),val="unix"===settings.outputFormat?date.unix():"input"===settings.outputFormat?$(this).val():date.format(settings.outputFormat),elem.val(val)),elem.trigger("change")})}if(settings.showClearButton){var clearBtn=$("<button class='pikaday-clear-btn'></button>");clearBtn.html(settings.clearButtonText),container.append(clearBtn),input.trigger("change"),clearBtn.click(function(e){return self.clearDate(),e.preventDefault(),!1})}if(settings.showTodayButton){var todayBtn=$("<button class='pikaday-today-btn' ></button>");todayBtn.html(settings.todayButtonText),container.append(todayBtn),todayBtn.click(function(e){return self.gotoToday(),e.preventDefault(),!1})}})},$.fn.pikaday.defaults={displayFormat:"DD.MM.YYYY",outputFormat:"unix",hasTouch:Modernizr.touch,hasNativeDate:Modernizr.inputtypes.date,forcePikaday:!1,placeholder:"",classes:"",pikadayOptions:{},showTodayButton:!1,showClearButton:!1,todayButtonText:"Today",clearButtonText:"Clear"}}(jQuery);